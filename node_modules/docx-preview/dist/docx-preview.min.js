!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.docx=t():e.docx=t()}(window,function(){return function(e){var t={};function r(a){if(t[a])return t[a].exports;var n=t[a]={i:a,l:!1,exports:{}};return e[a].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(a,n,function(t){return e[t]}.bind(null,n));return a},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=1)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Document=0]="Document",e[e.Paragraph=1]="Paragraph",e[e.Run=2]="Run",e[e.Break=3]="Break",e[e.Table=4]="Table",e[e.Row=5]="Row",e[e.Cell=6]="Cell",e[e.Hyperlink=7]="Hyperlink",e[e.Drawing=8]="Drawing",e[e.Image=9]="Image"}(t.DomType||(t.DomType={})),function(e){e[e.Settings=0]="Settings",e[e.Theme=1]="Theme",e[e.StylesWithEffects=2]="StylesWithEffects",e[e.Styles=3]="Styles",e[e.FontTable=4]="FontTable",e[e.Image=5]="Image",e[e.WebSettings=6]="WebSettings",e[e.Unknown=7]="Unknown"}(t.DomRelationshipType||(t.DomRelationshipType={}))},function(e,t,r){"use strict";var a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),s=r(3),o=r(7);t.renderAsync=function(e,t,r,l){void 0===r&&(r=null),void 0===l&&(l=null);var i=new s.DocumentParser,c=new o.HtmlRenderer(window.document);return(l=a({ignoreHeight:!0,ignoreWidth:!1,debug:!1,className:"docx",inWrapper:!0},l))&&(l.ignoreWidth=l.ignoreWidth||i.ignoreWidth,l.ignoreHeight=l.ignoreHeight||i.ignoreHeight,i.debug=l.debug||i.debug,c.className=l.className||"docx",c.inWrapper=null==l.inWrapper||l.inWrapper),n.Document.load(e,i).then(function(e){return c.render(e,t,r,l),e})}},function(e,t,r){"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Document="word/document.xml",e.Style="word/styles.xml",e.Numbering="word/numbering.xml",e.DocumentRelations="word/_rels/document.xml.rels",e.NumberingRelations="word/_rels/numbering.xml.rels",e.FontRelations="word/_rels/fontTable.xml.rels"}(a||(a={}));var n=function(){function e(){this.zip=new JSZip,this.docRelations=null,this.fontRelations=null,this.numRelations=null,this.styles=null,this.fonts=null,this.numbering=null,this.document=null}return e.load=function(t,r){var n=new e;return n.zip.loadAsync(t).then(function(e){var t=[n.loadPart(a.DocumentRelations,r),n.loadPart(a.FontRelations,r),n.loadPart(a.NumberingRelations,r),n.loadPart(a.Style,r),n.loadPart(a.Numbering,r),n.loadPart(a.Document,r)];return Promise.all(t.filter(function(e){return null!=e})).then(function(e){return n})})},e.prototype.loadDocumentImage=function(e){return this.loadResource(this.docRelations,e).then(function(e){return e?"data:image/png;base64,"+e:null})},e.prototype.loadNumberingImage=function(e){return this.loadResource(this.numRelations,e).then(function(e){return e?"data:image/png;base64,"+e:null})},e.prototype.loadFont=function(e){return this.loadResource(this.fontRelations,e).then(function(e){return e?"data:application/vnd.ms-package.obfuscated-opentype;charset=utf-8;base64,"+e:null})},e.prototype.loadResource=function(e,t){var r=e.filter(function(e){return e.id==t});return 0==r.length?Promise.resolve(null):this.zip.files["word/"+r[0].target].async("base64")},e.prototype.loadPart=function(e,t){var r=this,n=this.zip.files[e];return n?n.async("string").then(function(n){switch(e){case a.FontRelations:r.fontRelations=t.parseDocumentRelationsFile(n);break;case a.DocumentRelations:r.docRelations=t.parseDocumentRelationsFile(n);break;case a.NumberingRelations:r.numRelations=t.parseDocumentRelationsFile(n);break;case a.Style:r.styles=t.parseStylesFile(n);break;case a.Numbering:r.numbering=t.parseNumberingFile(n);break;case a.Document:r.document=t.parseDocumentFile(n)}return r}):null},e}();t.Document=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=r(4),s=r(5),o=r(6);t.autos={shd:"white",color:"black",highlight:"transparent"};var l,i=function(){function e(){this.skipDeclaration=!0,this.ignoreWidth=!1,this.ignoreHeight=!0,this.debug=!1}return e.prototype.parseDocumentRelationsFile=function(e){var t=c.parse(e,this.skipDeclaration);return c.elements(t).map(function(e){return{id:c.stringAttr(e,"Id"),type:u.valueOfRelType(e),target:c.stringAttr(e,"Target")}})},e.prototype.parseDocumentFile=function(e){var t=this,r={domType:a.DomType.Document,children:[],style:{},props:null},n=c.byTagName(c.parse(e,this.skipDeclaration),"body");return c.foreach(n,function(e){switch(e.localName){case"p":r.children.push(t.parseParagraph(e));break;case"tbl":r.children.push(t.parseTable(e));break;case"sectPr":r.props=t.parseSectionProperties(e)}}),r},e.prototype.parseStylesFile=function(e){var t=this,r=[],a=c.parse(e,this.skipDeclaration);return c.foreach(a,function(e){switch(e.localName){case"style":r.push(t.parseStyle(e));break;case"docDefaults":r.push(t.parseDefaultStyles(e))}}),r},e.prototype.parseDefaultStyles=function(e){var t=this,r={id:null,name:null,target:null,basedOn:null,styles:[]};return c.foreach(e,function(e){switch(e.localName){case"rPrDefault":var a=c.byTagName(e,"rPr");a&&r.styles.push({target:"span",values:t.parseDefaultProperties(a,{})});break;case"pPrDefault":var n=c.byTagName(e,"pPr");n&&r.styles.push({target:"p",values:t.parseDefaultProperties(n,{})})}}),r},e.prototype.parseCommonProperties=function(e,t){if(e.namespaceURI==s.namespaces.wordml)switch(e.localName){case"color":t.color=o.getAttributeColorValue(e,e.namespaceURI,"val");break;case"sz":t.fontSize=o.getAttributeLengthValue(e,e.namespaceURI,"val",o.LengthUsage.FontSize)}},e.prototype.parseStyle=function(e){var t=this,r={id:c.className(e,"styleId"),isDefault:c.boolAttr(e,"default"),name:null,target:null,basedOn:null,styles:[],linked:null};switch(c.stringAttr(e,"type")){case"paragraph":r.target="p";break;case"table":r.target="table";break;case"character":r.target="span"}return c.foreach(e,function(e){switch(e.localName){case"basedOn":r.basedOn=c.className(e,"val");break;case"name":r.name=c.stringAttr(e,"val");break;case"link":r.linked=c.className(e,"val");break;case"aliases":r.aliases=c.stringAttr(e,"val").split(",");break;case"pPr":r.styles.push({target:"p",values:t.parseDefaultProperties(e,{})});break;case"rPr":r.styles.push({target:"span",values:t.parseDefaultProperties(e,{})});break;case"tblPr":case"tcPr":r.styles.push({target:"td",values:t.parseDefaultProperties(e,{})});break;case"tblStylePr":for(var a=0,n=t.parseTableStyle(e);a<n.length;a++){var s=n[a];r.styles.push(s)}break;case"rsid":case"qFormat":case"hidden":case"semiHidden":case"unhideWhenUsed":case"autoRedefine":case"uiPriority":break;default:t.debug&&console.warn("DOCX: Unknown style element: "+e.localName)}}),r},e.prototype.parseTableStyle=function(e){var t=this,r=[],a=c.stringAttr(e,"type"),n="";switch(a){case"firstRow":n="tr.first-row td";break;case"lastRow":n="tr.last-row td";break;case"firstCol":n="td.first-col";break;case"lastCol":n="td.last-col";break;case"band1Vert":n="td.odd-col";break;case"band2Vert":n="td.even-col";break;case"band1Horz":n="tr.odd-row";break;case"band2Horz":n="tr.even-row";break;default:return[]}return c.foreach(e,function(e){switch(e.localName){case"pPr":r.push({target:n+" p",values:t.parseDefaultProperties(e,{})});break;case"rPr":r.push({target:n+" span",values:t.parseDefaultProperties(e,{})});break;case"tblPr":case"tcPr":r.push({target:n,values:t.parseDefaultProperties(e,{})})}}),r},e.prototype.parseNumberingFile=function(e){var t=this,r=[],a=c.parse(e,this.skipDeclaration),n={},s=[];return c.foreach(a,function(e){switch(e.localName){case"abstractNum":t.parseAbstractNumbering(e,s).forEach(function(e){return r.push(e)});break;case"numPicBullet":s.push(t.parseNumberingPicBullet(e));break;case"num":var a=c.stringAttr(e,"numId"),o=c.elementStringAttr(e,"abstractNumId","val");n[o]=a}}),r.forEach(function(e){return e.id=n[e.id]}),r},e.prototype.parseNumberingPicBullet=function(e){var t=c.byTagName(e,"pict"),r=t&&c.byTagName(t,"shape"),a=r&&c.byTagName(r,"imagedata");return a?{id:c.intAttr(e,"numPicBulletId"),src:c.stringAttr(a,"id"),style:c.stringAttr(r,"style")}:null},e.prototype.parseAbstractNumbering=function(e,t){var r=this,a=[],n=c.stringAttr(e,"abstractNumId");return c.foreach(e,function(e){switch(e.localName){case"lvl":a.push(r.parseNumberingLevel(n,e,t))}}),a},e.prototype.parseNumberingLevel=function(e,t,r){var a=this,n={id:e,level:c.intAttr(t,"ilvl"),style:{}};return c.foreach(t,function(e){switch(e.localName){case"pPr":a.parseDefaultProperties(e,n.style);break;case"lvlPicBulletId":var t=c.intAttr(e,"val");n.bullet=r.filter(function(e){return e.id==t})[0];break;case"lvlText":n.levelText=c.stringAttr(e,"val");break;case"numFmt":n.format=c.stringAttr(e,"val")}}),n},e.prototype.parseSectionProperties=function(e){var t=this,r={};return o.forEachElementNS(e,s.namespaces.wordml,function(e){switch(e.localName){case"pgSz":r.pageSize={width:o.getAttributeLengthValue(e,s.namespaces.wordml,"w"),height:o.getAttributeLengthValue(e,s.namespaces.wordml,"h"),orientation:e.getAttributeNS(s.namespaces.wordml,"orient")};break;case"pgMar":r.pageMargins={left:o.getAttributeLengthValue(e,s.namespaces.wordml,"left"),right:o.getAttributeLengthValue(e,s.namespaces.wordml,"right"),top:o.getAttributeLengthValue(e,s.namespaces.wordml,"top"),bottom:o.getAttributeLengthValue(e,s.namespaces.wordml,"bottom"),header:o.getAttributeLengthValue(e,s.namespaces.wordml,"header"),footer:o.getAttributeLengthValue(e,s.namespaces.wordml,"footer"),gutter:o.getAttributeLengthValue(e,s.namespaces.wordml,"gutter")};break;case"cols":r.columns=t.parseColumns(e)}}),r},e.prototype.parseColumns=function(e){var t={numberOfColumns:o.getAttributeIntValue(e,s.namespaces.wordml,"num"),space:o.getAttributeLengthValue(e,s.namespaces.wordml,"space"),separator:o.getAttributeBoolValue(e,s.namespaces.wordml,"sep"),equalWidth:o.getAttributeBoolValue(e,s.namespaces.wordml,"equalWidth",!0),columns:[]};return o.forEachElementNS(e,s.namespaces.wordml,function(r){"col"==r.localName&&t.columns.push({width:o.getAttributeLengthValue(e,s.namespaces.wordml,"w"),space:o.getAttributeLengthValue(e,s.namespaces.wordml,"space")})}),t},e.prototype.parseParagraph=function(e){var t=this,r={domType:a.DomType.Paragraph,children:[],props:{}};return c.foreach(e,function(e){switch(e.localName){case"r":r.children.push(t.parseRun(e,r));break;case"hyperlink":r.children.push(t.parseHyperlink(e,r));break;case"bookmarkStart":r.children.push(t.parseBookmark(e));break;case"pPr":t.parseParagraphProperties(e,r),t.parseCommonProperties(e,r.props)}}),r},e.prototype.parseParagraphProperties=function(e,t){var r=this;this.parseDefaultProperties(e,t.style={},null,function(e){switch(e.localName){case"pStyle":n.addElementClass(t,c.className(e,"val"));break;case"cnfStyle":n.addElementClass(t,u.classNameOfCnfStyle(e));break;case"numPr":r.parseNumbering(e,t);break;case"framePr":r.parseFrame(e,t);break;case"tabs":r.parseTabs(e,t);break;case"rPr":break;default:return!1}return!0})},e.prototype.parseNumbering=function(e,t){c.foreach(e,function(e){switch(e.localName){case"numId":t.numberingId=c.stringAttr(e,"val");break;case"ilvl":t.numberingLevel=c.intAttr(e,"val")}})},e.prototype.parseFrame=function(e,t){"drop"==c.stringAttr(e,"dropCap")&&(t.style.float="left")},e.prototype.parseBookmark=function(e){var t={domType:a.DomType.Run};return t.id=c.stringAttr(e,"name"),t},e.prototype.parseHyperlink=function(e,t){var r=this,n={domType:a.DomType.Hyperlink,parent:t,children:[]},s=c.stringAttr(e,"anchor");return s&&(n.href="#"+s),c.foreach(e,function(e){switch(e.localName){case"r":n.children.push(r.parseRun(e,n))}}),n},e.prototype.parseRun=function(e,t){var r=this,n={domType:a.DomType.Run,parent:t};return c.foreach(e,function(e){switch(e.localName){case"t":n.text=e.textContent;break;case"br":n.break=c.stringAttr(e,"type")||"textWrapping";break;case"tab":n.tab=!0;break;case"drawing":var t=r.parseDrawing(e);t&&(n.children=[t]);break;case"rPr":r.parseRunProperties(e,n)}}),n},e.prototype.parseRunProperties=function(e,t){this.parseDefaultProperties(e,t.style={},null,function(e){switch(e.localName){case"rStyle":t.className=c.className(e,"val");break;case"vertAlign":switch(c.stringAttr(e,"val")){case"subscript":t.wrapper="sub";break;case"superscript":t.wrapper="sup"}break;default:return!1}return!0})},e.prototype.parseDrawing=function(e){for(var t=0,r=c.elements(e);t<r.length;t++){var a=r[t];switch(a.localName){case"inline":case"anchor":return this.parseDrawingWrapper(a)}}},e.prototype.parseDrawingWrapper=function(e){for(var t={domType:a.DomType.Drawing,children:[],style:{}},r="anchor"==e.localName,n=null,s=c.boolAttr(e,"simplePos"),o={relative:"page",align:"left",offset:"0"},i={relative:"page",align:"top",offset:"0"},u=0,p=c.elements(e);u<p.length;u++){var d=p[u];switch(d.localName){case"simplePos":s&&(o.offset=c.sizeAttr(d,"x",l.Emu),i.offset=c.sizeAttr(d,"y",l.Emu));break;case"extent":t.style.width=c.sizeAttr(d,"cx",l.Emu),t.style.height=c.sizeAttr(d,"cy",l.Emu);break;case"positionH":case"positionV":if(!s){var h="positionH"==d.localName?o:i,m=c.byTagName(d,"align"),f=c.byTagName(d,"posOffset");m&&(h.align=m.textContent),f&&(h.offset=c.sizeValue(f,l.Emu))}break;case"wrapTopAndBottom":n="wrapTopAndBottom";break;case"wrapNone":n="wrapNone";break;case"graphic":var g=this.parseGraphic(d);g&&t.children.push(g)}}return"wrapTopAndBottom"==n?(t.style.display="block",o.align&&(t.style["text-align"]=o.align,t.style.width="100%")):"wrapNone"==n?(t.style.display="block",t.style.position="relative",t.style.width="0px",t.style.height="0px",o.offset&&(t.style.left=o.offset),i.offset&&(t.style.top=i.offset)):!r||"left"!=o.align&&"right"!=o.align||(t.style.float=o.align),t},e.prototype.parseGraphic=function(e){for(var t=c.byTagName(e,"graphicData"),r=0,a=c.elements(t);r<a.length;r++){var n=a[r];switch(n.localName){case"pic":return this.parsePicture(n)}}return null},e.prototype.parsePicture=function(e){var t={domType:a.DomType.Image,src:"",style:{}},r=c.byTagName(e,"blipFill"),n=c.byTagName(r,"blip");t.src=c.stringAttr(n,"embed");var s=c.byTagName(e,"spPr"),o=c.byTagName(s,"xfrm");t.style.position="relative";for(var i=0,u=c.elements(o);i<u.length;i++){var p=u[i];switch(p.localName){case"ext":t.style.width=c.sizeAttr(p,"cx",l.Emu),t.style.height=c.sizeAttr(p,"cy",l.Emu);break;case"off":t.style.left=c.sizeAttr(p,"x",l.Emu),t.style.top=c.sizeAttr(p,"y",l.Emu)}}return t},e.prototype.parseTable=function(e){var t=this,r={domType:a.DomType.Table,children:[]};return c.foreach(e,function(e){switch(e.localName){case"tr":r.children.push(t.parseTableRow(e));break;case"tblGrid":r.columns=t.parseTableColumns(e);break;case"tblPr":t.parseTableProperties(e,r)}}),r},e.prototype.parseTableColumns=function(e){var t=[];return c.foreach(e,function(e){switch(e.localName){case"gridCol":t.push({width:c.sizeAttr(e,"w")})}}),t},e.prototype.parseTableProperties=function(e,t){var r=this;switch(t.style={},t.cellStyle={},this.parseDefaultProperties(e,t.style,t.cellStyle,function(e){switch(e.localName){case"tblStyle":t.className=c.className(e,"val");break;case"tblLook":n.addElementClass(t,u.classNameOftblLook(e));break;case"tblpPr":r.parseTablePosition(e,t);break;default:return!1}return!0}),t.style["text-align"]){case"center":delete t.style["text-align"],t.style["margin-left"]="auto",t.style["margin-right"]="auto";break;case"right":delete t.style["text-align"],t.style["margin-left"]="auto"}},e.prototype.parseTablePosition=function(e,t){c.stringAttr(e,"vertAnchor"),c.stringAttr(e,"horzAnchor"),c.sizeAttr(e,"tblpX"),c.sizeAttr(e,"tblpY"),c.stringAttr(e,"tblpXSpec"),c.stringAttr(e,"tblpYSpec");var r=c.sizeAttr(e,"topFromText"),a=c.sizeAttr(e,"bottomFromText"),n=c.sizeAttr(e,"rightFromText"),s=c.sizeAttr(e,"leftFromText");t.style.float="left",t.style["margin-bottom"]=u.addSize(t.style["margin-bottom"],a),t.style["margin-left"]=u.addSize(t.style["margin-left"],s),t.style["margin-right"]=u.addSize(t.style["margin-right"],n),t.style["margin-top"]=u.addSize(t.style["margin-top"],r)},e.prototype.parseTableRow=function(e){var t=this,r={domType:a.DomType.Row,children:[]};return c.foreach(e,function(e){switch(e.localName){case"tc":r.children.push(t.parseTableCell(e));break;case"trPr":t.parseTableRowProperties(e,r)}}),r},e.prototype.parseTableRowProperties=function(e,t){t.style=this.parseDefaultProperties(e,{},null,function(e){switch(e.localName){case"cnfStyle":t.className=u.classNameOfCnfStyle(e);break;default:return!1}return!0})},e.prototype.parseTableCell=function(e){var t=this,r={domType:a.DomType.Cell,children:[]};return c.foreach(e,function(e){switch(e.localName){case"tbl":r.children.push(t.parseTable(e));break;case"p":r.children.push(t.parseParagraph(e));break;case"tcPr":t.parseTableCellProperties(e,r)}}),r},e.prototype.parseTableCellProperties=function(e,t){t.style=this.parseDefaultProperties(e,{},null,function(e){switch(e.localName){case"gridSpan":t.span=c.intAttr(e,"val",null);break;case"vMerge":break;case"cnfStyle":t.className=u.classNameOfCnfStyle(e);break;default:return!1}return!0})},e.prototype.parseDefaultProperties=function(e,r,a,n){var s=this;return void 0===r&&(r=null),void 0===a&&(a=null),void 0===n&&(n=null),r=r||{},c.foreach(e,function(o){switch(o.localName){case"jc":r["text-align"]=u.valueOfJc(o);break;case"textAlignment":r["vertical-align"]=u.valueOfTextAlignment(o);break;case"color":r.color=c.colorAttr(o,"val",null,t.autos.color);break;case"sz":r["font-size"]=c.sizeAttr(o,"val",l.FontSize);break;case"shd":r["background-color"]=c.colorAttr(o,"fill",null,t.autos.shd);break;case"highlight":r["background-color"]=c.colorAttr(o,"val",null,t.autos.highlight);break;case"tcW":if(s.ignoreWidth)break;case"tblW":r.width=u.valueOfSize(o,"w");break;case"trHeight":s.parseTrHeight(o,r);break;case"strike":r["text-decoration"]=u.valueOfStrike(o);break;case"b":r["font-weight"]=u.valueOfBold(o);break;case"i":r["font-style"]="italic";break;case"u":s.parseUnderline(o,r);break;case"ind":case"tblInd":s.parseIndentation(o,r);break;case"rFonts":s.parseFont(o,r);break;case"tblBorders":s.parseBorderProperties(o,a||r);break;case"tblCellSpacing":r["border-spacing"]=u.valueOfMargin(o),r["border-collapse"]="separate";break;case"pBdr":case"tcBorders":s.parseBorderProperties(o,r);break;case"noWrap":break;case"tblCellMar":case"tcMar":s.parseMarginProperties(o,a||r);break;case"tblLayout":r["table-layout"]=u.valueOfTblLayout(o);break;case"vAlign":r["vertical-align"]=c.stringAttr(o,"val");break;case"spacing":"pPr"==e.localName&&s.parseSpacing(o,r);break;case"lang":case"noProof":case"webHidden":break;default:null==n||n(o)||s.debug&&console.warn("DOCX: Unknown document element: "+o.localName)}}),r},e.prototype.parseUnderline=function(e,t){var r=c.stringAttr(e,"val");if(null!=r&&"none"!=r){switch(r){case"dash":case"dashDotDotHeavy":case"dashDotHeavy":case"dashedHeavy":case"dashLong":case"dashLongHeavy":case"dotDash":case"dotDotDash":t["text-decoration-style"]="dashed";break;case"dotted":case"dottedHeavy":t["text-decoration-style"]="dotted";break;case"double":t["text-decoration-style"]="double";break;case"single":case"thick":t["text-decoration"]="underline";break;case"wave":case"wavyDouble":case"wavyHeavy":t["text-decoration-style"]="wavy";break;case"words":t["text-decoration"]="underline"}var a=c.colorAttr(e,"color");a&&(t["text-decoration-color"]=a)}},e.prototype.parseFont=function(e,t){var r=c.stringAttr(e,"ascii");r&&(t["font-family"]=r)},e.prototype.parseIndentation=function(e,t){var r=c.sizeAttr(e,"firstLine"),a=c.sizeAttr(e,"left"),n=c.sizeAttr(e,"start"),s=c.sizeAttr(e,"right"),o=c.sizeAttr(e,"end");r&&(t["text-indent"]=r),(a||n)&&(t["margin-left"]=a||n),(s||o)&&(t["margin-right"]=s||o)},e.prototype.parseSpacing=function(e,t){var r=c.sizeAttr(e,"before"),a=c.sizeAttr(e,"after"),n=c.intAttr(e,"line",null),s=c.stringAttr(e,"lineRule");if(r&&(t["margin-top"]=r),a&&(t["margin-bottom"]=a),null!==n)switch(s){case"auto":t["line-height"]=""+(n/240).toFixed(2);break;case"atLeast":t["line-height"]="calc(100% + "+n/20+"pt)";break;default:t["line-height"]=t["min-height"]=n/20+"pt"}},e.prototype.parseTabs=function(e,t){t.tabs=c.elements(e,"tab").map(function(e){return{position:c.sizeAttr(e,"pos"),leader:c.stringAttr(e,"leader"),style:c.stringAttr(e,"val")}})},e.prototype.parseMarginProperties=function(e,t){c.foreach(e,function(e){switch(e.localName){case"left":t["padding-left"]=u.valueOfMargin(e);break;case"right":t["padding-right"]=u.valueOfMargin(e);break;case"top":t["padding-top"]=u.valueOfMargin(e);break;case"bottom":t["padding-bottom"]=u.valueOfMargin(e)}})},e.prototype.parseTrHeight=function(e,t){switch(c.stringAttr(e,"hRule")){case"exact":t.height=c.sizeAttr(e,"val");break;case"atLeast":default:t.height=c.sizeAttr(e,"val")}},e.prototype.parseBorderProperties=function(e,t){c.foreach(e,function(e){switch(e.localName){case"start":case"left":t["border-left"]=u.valueOfBorder(e);break;case"end":case"right":t["border-right"]=u.valueOfBorder(e);break;case"top":t["border-top"]=u.valueOfBorder(e);break;case"bottom":t["border-bottom"]=u.valueOfBorder(e)}})},e}();t.DocumentParser=i,function(e){e[e.FontSize=0]="FontSize",e[e.Dxa=1]="Dxa",e[e.Emu=2]="Emu",e[e.Border=3]="Border",e[e.Percent=4]="Percent"}(l||(l={}));var c=function(){function e(){}return e.parse=function(e,t){return void 0===t&&(t=!0),t&&(e=e.replace(/<[?].*[?]>/,"")),(new DOMParser).parseFromString(e,"application/xml").firstChild},e.elements=function(e,t){void 0===t&&(t=null);for(var r=[],a=0;a<e.childNodes.length;a++){var n=e.childNodes[a];1!=n.nodeType||null!=t&&n.localName!=t||r.push(n)}return r},e.foreach=function(e,t){for(var r=0;r<e.childNodes.length;r++){var a=e.childNodes[r];1==a.nodeType&&t(a)}},e.byTagName=function(e,t){for(var r=0;r<e.childNodes.length;r++){var a=e.childNodes[r];if(1==a.nodeType&&a.localName==t)return e.childNodes[r]}return null},e.elementStringAttr=function(t,r,a){var n=e.byTagName(t,r);return n?e.stringAttr(n,a):null},e.stringAttr=function(e,t){for(var r=e,a=0;a<r.attributes.length;a++){var n=r.attributes.item(a);if(n.localName==t)return n.value}return null},e.colorAttr=function(t,r,a,n){void 0===a&&(a=null),void 0===n&&(n="black");var s=e.stringAttr(t,r);switch(s){case"yellow":return s;case"auto":return n}return s?"#"+s:a},e.boolAttr=function(t,r,a){switch(void 0===a&&(a=!1),e.stringAttr(t,r)){case"1":return!0;case"0":return!1}return a},e.intAttr=function(t,r,a){return void 0===a&&(a=0),e.stringAttr(t,r)?parseInt(e.stringAttr(t,r)):a},e.sizeAttr=function(t,r,a){return void 0===a&&(a=l.Dxa),e.convertSize(e.stringAttr(t,r),a)},e.sizeValue=function(t,r){return void 0===r&&(r=l.Dxa),e.convertSize(t.textContent,r)},e.convertSize=function(e,t){if(void 0===t&&(t=l.Dxa),null==e||e.indexOf("pt")>-1)return e;var r=parseInt(e);switch(t){case l.Dxa:return(.05*r).toFixed(2)+"pt";case l.Emu:return(r/12700).toFixed(2)+"pt";case l.FontSize:return(.5*r).toFixed(2)+"pt";case l.Border:return(.125*r).toFixed(2)+"pt";case l.Percent:return(.02*r).toFixed(2)+"%"}return e},e.className=function(t,r){var a=e.stringAttr(t,r);return a&&a.replace(/[ .]+/g,"-").replace(/[&]+/g,"and")},e}(),u=function(){function e(){}return e.valueOfBold=function(e){return c.boolAttr(e,"val",!0)?"bold":"normal"},e.valueOfSize=function(e,t){var r=l.Dxa;switch(c.stringAttr(e,"type")){case"dxa":break;case"pct":r=l.Percent}return c.sizeAttr(e,t,r)},e.valueOfStrike=function(e){return c.boolAttr(e,"val",!0)?"line-through":"none"},e.valueOfMargin=function(e){return c.sizeAttr(e,"w")},e.valueOfRelType=function(e){switch(c.sizeAttr(e,"Type")){case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings":return a.DomRelationshipType.Settings;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme":return a.DomRelationshipType.Theme;case"http://schemas.microsoft.com/office/2007/relationships/stylesWithEffects":return a.DomRelationshipType.StylesWithEffects;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles":return a.DomRelationshipType.Styles;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/fontTable":return a.DomRelationshipType.FontTable;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image":return a.DomRelationshipType.Image;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/webSettings":return a.DomRelationshipType.WebSettings}return a.DomRelationshipType.Unknown},e.valueOfBorder=function(e){if("nil"==c.stringAttr(e,"val"))return"none";var t=c.colorAttr(e,"color");return c.sizeAttr(e,"sz",l.Border)+" solid "+("auto"==t?"black":t)},e.valueOfTblLayout=function(e){return"fixed"==c.stringAttr(e,"val")?"fixed":"auto"},e.classNameOfCnfStyle=function(e){var t="",r=c.stringAttr(e,"val");return"1"==r[0]&&(t+=" first-row"),"1"==r[1]&&(t+=" last-row"),"1"==r[2]&&(t+=" first-col"),"1"==r[3]&&(t+=" last-col"),"1"==r[4]&&(t+=" odd-col"),"1"==r[5]&&(t+=" even-col"),"1"==r[6]&&(t+=" odd-row"),"1"==r[7]&&(t+=" even-row"),"1"==r[8]&&(t+=" ne-cell"),"1"==r[9]&&(t+=" nw-cell"),"1"==r[10]&&(t+=" se-cell"),"1"==r[11]&&(t+=" sw-cell"),t.trim()},e.valueOfJc=function(e){var t=c.stringAttr(e,"val");switch(t){case"start":case"left":return"left";case"center":return"center";case"end":case"right":return"right";case"both":return"justify"}return t},e.valueOfTextAlignment=function(e){var t=c.stringAttr(e,"val");switch(t){case"auto":case"baseline":return"baseline";case"top":return"top";case"center":return"middle";case"bottom":return"bottom"}return t},e.addSize=function(e,t){return null==e?t:null==t?e:"calc("+e+" + "+t+")"},e.checkMask=function(e,t){return(e&t)==t},e.classNameOftblLook=function(e){var t="";return c.boolAttr(e,"firstColumn")&&(t+=" first-col"),c.boolAttr(e,"firstRow")&&(t+=" first-row"),c.boolAttr(e,"lastColumn")&&(t+=" lat-col"),c.boolAttr(e,"lastRow")&&(t+=" last-row"),c.boolAttr(e,"noHBand")&&(t+=" no-hband"),c.boolAttr(e,"noVBand")&&(t+=" no-vband"),t.trim()},e}()},function(e,t,r){"use strict";function a(e,t){return e?e+" "+t:t}Object.defineProperty(t,"__esModule",{value:!0}),t.addElementClass=function(e,t){return e.className=a(e.className,t)},t.appendClass=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.namespaces={wordml:"http://schemas.openxmlformats.org/wordprocessingml/2006/main"}},function(e,t,r){"use strict";var a;function n(e,t){if(void 0===t&&(t=a.Dxa),!e)return null;var r=parseInt(e);switch(t){case a.Dxa:return{value:.05*r,type:"pt"};case a.Emu:return{value:r/12700,type:"pt"};case a.FontSize:return{value:.5*r,type:"pt"};case a.Border:return{value:.125*r,type:"pt"};case a.Percent:return{value:.02*r,type:"%"}}return null}Object.defineProperty(t,"__esModule",{value:!0}),t.forEachElementNS=function(e,t,r){for(var a=0;a<e.childNodes.length;a++){var n=e.childNodes[a];1==n.nodeType&&n.namespaceURI==t&&r(n)}},t.getAttributeIntValue=function(e,t,r){var a=e.getAttributeNS(t,r);return a?parseInt(a):null},t.getAttributeColorValue=function(e,t,r){var a=e.getAttributeNS(t,r);return a?"#"+a:null},t.getAttributeBoolValue=function(e,t,r,a){void 0===a&&(a=!1);var n=e.getAttributeNS(t,r);return null==n?a:"true"===n||"1"===n},t.getAttributeLengthValue=function(e,t,r,s){return void 0===s&&(s=a.Dxa),n(e.getAttributeNS(t,r),s)},function(e){e[e.Dxa=0]="Dxa",e[e.Emu=1]="Emu",e[e.FontSize=2]="FontSize",e[e.Border=3]="Border",e[e.Percent=4]="Percent"}(a=t.LengthUsage||(t.LengthUsage={})),t.parseLength=n},function(e,t,r){"use strict";var a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),s=function(){function e(e){this.htmlDocument=e,this.inWrapper=!0,this.className="docx",this.digitTest=/^[0-9]/.test}return e.prototype.render=function(e,t,r,a){void 0===r&&(r=null),this.document=e,this.options=a,r=r||t,this.clearElement(r),this.clearElement(t),r.appendChild(this.htmlDocument.createComment("docxjs library predefined styles")),r.appendChild(this.renderDefaultStyle()),r.appendChild(this.htmlDocument.createComment("docx document styles")),r.appendChild(this.renderStyles(e.styles)),e.numbering&&(r.appendChild(this.htmlDocument.createComment("docx document numbering styles")),r.appendChild(this.renderNumbering(e.numbering,r)));var n=this.renderDocument(e.document);if(this.inWrapper){var s=this.renderWrapper();s.appendChild(n),t.appendChild(s)}else t.appendChild(n)},e.prototype.clearElement=function(e){for(;e.firstChild;)e.removeChild(e.firstChild)},e.prototype.processClassName=function(e){return e?this.className+"_"+e:this.className},e.prototype.processStyles=function(e){for(var t={},r=0,a=e.filter(function(e){return null!=e.id});r<a.length;r++){t[(m=a[r]).id]=m}for(var n=0,s=e.filter(function(e){return e.basedOn});n<s.length;n++){var o=t[(m=s[n]).basedOn];if(o)for(var l,i=function(e){(l=o.styles.filter(function(t){return t.target==e.target}))&&l.length>0&&c.copyStyleProperties(l[0].values,e.values)},c=this,u=0,p=m.styles;u<p.length;u++){i(p[u])}else this.options.debug&&console.warn("Can't find base style "+m.basedOn)}for(var d=0,h=e;d<h.length;d++){var m;(m=h[d]).id=this.processClassName(m.id)}return t},e.prototype.processElement=function(e){if(e.children)for(var t=0,r=e.children;t<r.length;t++){var a=r[t];a.className=this.processClassName(a.className),a.domType==n.DomType.Table?this.processTable(a):this.processElement(a)}},e.prototype.processTable=function(e){for(var t=0,r=e.children;t<r.length;t++)for(var a=0,n=r[t].children;a<n.length;a++){var s=n[a];s.style=this.copyStyleProperties(e.cellStyle,s.style,["border-left","border-right","border-top","border-bottom","padding-left","padding-right","padding-top","padding-bottom"]),this.processElement(s)}},e.prototype.copyStyleProperties=function(e,t,r){if(void 0===r&&(r=null),!e)return t;null==t&&(t={}),null==r&&(r=Object.getOwnPropertyNames(e));for(var a=0,n=r;a<n.length;a++){var s=n[a];e.hasOwnProperty(s)&&!t.hasOwnProperty(s)&&(t[s]=e[s])}return t},e.prototype.renderDocument=function(e){var t=this.htmlDocument.createElement("section");if(t.className=this.className,this.processElement(e),this.renderChildren(e,t),this.renderStyleValues(e.style,t),e.props){var r=e.props;r.pageMargins&&(t.style.paddingLeft=this.renderLength(r.pageMargins.left),t.style.paddingRight=this.renderLength(r.pageMargins.right),t.style.paddingTop=this.renderLength(r.pageMargins.top),t.style.paddingBottom=this.renderLength(r.pageMargins.bottom)),r.pageSize&&(this.options.ignoreWidth||(t.style.width=this.renderLength(r.pageSize.width)),this.options.ignoreHeight||(t.style.height=this.renderLength(r.pageSize.height))),r.columns&&r.columns.numberOfColumns&&(t.style.columnCount=""+r.columns.numberOfColumns,t.style.columnGap=this.renderLength(r.columns.space),r.columns.separator&&(t.style.columnRule="1px solid black"))}return t},e.prototype.renderLength=function(e){return e?""+e.value+e.type:null},e.prototype.renderWrapper=function(){var e=document.createElement("div");return e.className=this.className+"-wrapper",e},e.prototype.renderDefaultStyle=function(){var e="."+this.className+"-wrapper { background: gray; padding: 30px; display: flex; justify-content: center; } \n                ."+this.className+"-wrapper section."+this.className+" { background: white; box-shadow: 0 0 10px rgba(0, 0, 0, 0.5); }\n                ."+this.className+" { color: black; }\n                section."+this.className+" { box-sizing: border-box; }\n                ."+this.className+" table { border-collapse: collapse; }\n                ."+this.className+" table td, ."+this.className+" table th { vertical-align: top; }\n                ."+this.className+" p { margin: 0pt; }";return this.renderStyle(e)},e.prototype.renderNumbering=function(e,t){for(var r,n,s=this,o="",l=[],i=function(){if(r="p."+c.numberingClass(d.id,d.level),n="none",d.levelText&&"decimal"==d.format){var e=c.numberingCounter(d.id,d.level);d.level>0?o+=c.styleToString("p."+c.numberingClass(d.id,d.level-1),{"counter-reset":e}):l.push(e),o+=c.styleToString(r+":before",{content:c.levelTextToContent(d.levelText,d.id),"counter-increment":e}),o+=c.styleToString(r,a({display:"list-item","list-style-position":"inside","list-style-type":"none"},d.style))}else if(d.bullet){var i=("--"+c.className+"-"+d.bullet.src).toLowerCase();o+=c.styleToString(r+":before",{content:"' '",display:"inline-block",background:"var("+i+")"},d.bullet.style),c.document.loadNumberingImage(d.bullet.src).then(function(e){var r="."+s.className+"-wrapper { "+i+": url("+e+") }";t.appendChild(s.renderStyle(r))})}else n=c.numFormatToCssValue(d.format);o+=c.styleToString(r,a({display:"list-item","list-style-position":"inside","list-style-type":n},d.style))},c=this,u=0,p=e;u<p.length;u++){var d=p[u];i()}return l.length>0&&(o+=this.styleToString("."+this.className+"-wrapper",{"counter-reset":l.join(" ")})),this.renderStyle(o)},e.prototype.renderStyle=function(e){var t=document.createElement("style");return t.type="text/css",t.innerHTML=e,t},e.prototype.renderStyles=function(e){for(var t="",r=this.processStyles(e),a=0,n=e;a<n.length;a++){var s=n[a],o=s.styles;if(s.linked){var l=s.linked&&r[s.linked];l?o=o.concat(l.styles):this.options.debug&&console.warn("Can't find linked style "+s.linked)}for(var i=0,c=o;i<c.length;i++){var u=c[i],p="";s.target==u.target?p+=s.target+"."+s.id:s.target?p+=s.target+"."+s.id+" "+u.target:p+="."+s.id+" "+u.target,s.isDefault&&s.target&&(p="."+this.className+" "+s.target+", "+p),t+=this.styleToString(p,u.values)}}return this.renderStyle(t)},e.prototype.renderElement=function(e,t){switch(e.domType){case n.DomType.Paragraph:return this.renderParagraph(e);case n.DomType.Run:return this.renderRun(e);case n.DomType.Table:return this.renderTable(e);case n.DomType.Row:return this.renderTableRow(e);case n.DomType.Cell:return this.renderTableCell(e);case n.DomType.Hyperlink:return this.renderHyperlink(e);case n.DomType.Drawing:return this.renderDrawing(e);case n.DomType.Image:return this.renderImage(e)}return null},e.prototype.renderChildren=function(e,t){var r=this,a=null;if(null!=e.children&&(a=e.children.map(function(t){return r.renderElement(t,e)}).filter(function(e){return null!=e})),t&&a)for(var n=0,s=a;n<s.length;n++){var o=s[n];t.appendChild(o)}return a},e.prototype.renderParagraph=function(e){var t=this.htmlDocument.createElement("p");return this.renderClass(e,t),this.renderChildren(e,t),this.renderStyleValues(e.style,t),this.renderCommonProeprties(t,e.props),e.numberingId&&null!=e.numberingLevel&&(t.className=t.className+" "+this.numberingClass(e.numberingId,e.numberingLevel)),t},e.prototype.renderCommonProeprties=function(e,t){null!=t&&(t.color&&(e.style.color=t.color),t.fontSize&&(e.style.fontSize=this.renderLength(t.fontSize)))},e.prototype.renderHyperlink=function(e){var t=this.htmlDocument.createElement("a");return this.renderChildren(e,t),this.renderStyleValues(e.style,t),e.href&&(t.href=e.href),t},e.prototype.renderDrawing=function(e){var t=this.htmlDocument.createElement("div");return t.style.display="inline-block",t.style.position="relative",t.style.textIndent="0px",this.renderChildren(e,t),this.renderStyleValues(e.style,t),t},e.prototype.renderImage=function(e){var t=this.htmlDocument.createElement("img");return this.renderStyleValues(e.style,t),this.document&&this.document.loadDocumentImage(e.src).then(function(e){t.src=e}),t},e.prototype.renderRun=function(e){if(e.break)return this.htmlDocument.createElement("page"==e.break?"hr":"br");var t=this.htmlDocument.createElement("span");if(e.text&&(t.textContent=e.text),this.renderClass(e,t),this.renderChildren(e,t),this.renderStyleValues(e.style,t),e.id&&(t.id=e.id),e.tab);else{if(e.href){var r=this.htmlDocument.createElement("a");return r.href=e.href,r.appendChild(t),r}if(e.wrapper){var a=this.htmlDocument.createElement(e.wrapper);return a.appendChild(t),a}}return t},e.prototype.renderTable=function(e){var t=this.htmlDocument.createElement("table");return this.renderClass(e,t),this.renderChildren(e,t),this.renderStyleValues(e.style,t),e.columns&&t.appendChild(this.renderTableColumns(e.columns)),t},e.prototype.renderTableColumns=function(e){for(var t=this.htmlDocument.createElement("colGroup"),r=0,a=e;r<a.length;r++){var n=a[r],s=this.htmlDocument.createElement("col");n.width&&(s.style.width=n.width+"px"),t.appendChild(s)}return t},e.prototype.renderTableRow=function(e){var t=this.htmlDocument.createElement("tr");return this.renderClass(e,t),this.renderChildren(e,t),this.renderStyleValues(e.style,t),t},e.prototype.renderTableCell=function(e){var t=this.htmlDocument.createElement("td");return this.renderClass(e,t),this.renderChildren(e,t),this.renderStyleValues(e.style,t),e.span&&(t.colSpan=e.span),t},e.prototype.renderStyleValues=function(e,t){if(null!=e)for(var r in e)e.hasOwnProperty(r)&&(t.style[r]=e[r])},e.prototype.renderClass=function(e,t){e.className&&(t.className=e.className)},e.prototype.numberingClass=function(e,t){return this.className+"-num-"+e+"-"+t},e.prototype.styleToString=function(e,t,r){void 0===r&&(r=null);var a=e+" {\r\n";for(var n in t)a+="  "+n+": "+t[n]+";\r\n";return r&&(a+=";"+r),a+"}\r\n"},e.prototype.numberingCounter=function(e,t){return this.className+"-num-"+e+"-"+t},e.prototype.levelTextToContent=function(e,t){var r=this;return'"'+e.replace(/%\d*/g,function(e){var a=parseInt(e.substring(1),10)-1;return'"counter('+r.numberingCounter(t,a)+')"'})+'"'},e.prototype.numFormatToCssValue=function(e){return{none:"none",bullet:"disc",decimal:"decimal",lowerLetter:"lower-alpha",upperLetter:"upper-alpha",lowerRoman:"lower-roman",upperRoman:"upper-roman"}[e]||e},e}();t.HtmlRenderer=s}])});
//# sourceMappingURL=docx-preview.min.js.map